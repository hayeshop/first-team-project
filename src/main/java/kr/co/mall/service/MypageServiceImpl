package kr.co.mall.service;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;
import org.springframework.ui.Model;

import kr.co.mall.mapper.MypageMapper;

@Service
@Qualifier("ms")
public class MyPageServiceImpl implements MypageService{

	@Autowired
	private MypageMapper mapper;

	@Override
	public String wishview(HttpSession session, Model model) {
		if(session.getAttribute("userid")==null)
		{
			return "redirect:/login/login";
		}
		else
		{
		  String userid=session.getAttribute("userid").toString();
		  model.addAttribute("wlist",mapper.wishview(userid));
		  return "/mypage/wishview";
		}
	}
	
	public String wishdel(HttpServletRequest request) {
		String[] id=request.getParameter("id").split(",");
		for(int i=0;i<id.length;i++)
		{
			System.out.println(id[i]);
			mapper.wishdel(id[i]);
		}
		
		return "redirect:/mypage/wishview";
	}
	
	@Override
	public String cartview(HttpSession session, Model model) {
		if(session.getAttribute("userid")==null)
		{
			return "redirect:/login/login";
		}
		else
		{
		  String userid=session.getAttribute("userid").toString();
		  model.addAttribute("clist",mapper.cartview(userid));
		  return "/mypage/cartview";
		}
	}

	@Override
	public String cartdel(HttpServletRequest request) {
		String[] id=request.getParameter("id").split(",");
		
		for(int i=0;i<id.length;i++)
		{
			mapper.cartdel(id[i]);
		}
		
		return "redirect:/mypage/cartview";
	}
}
